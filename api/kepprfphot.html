

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>kepprfphot: fit a PSF model to time series observations within a Target Pixel File &mdash; PyKE 3.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PyKE 3.0.0 documentation" href="../index.html"/>
        <link rel="up" title="List of PyKE tools" href="index.html"/>
        <link rel="next" title="keprange: define time ranges interactively for use with other PyKE tasks" href="keprange.html"/>
        <link rel="prev" title="kepprf: fit a PSF model to a specific image within a Target Pixel File" href="kepprf.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PyKE
          

          
            
            <img src="../_static/pyke-white.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/ipython_notebooks/whatsnew31.html">What’s new in PyKE 3.1?</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../overview.html">PyKE tasks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html#calling-tasks-from-python">Calling tasks from Python</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../overview.html#calling-tasks-from-a-terminal">Calling tasks from a terminal</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">List of PyKE tools</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="kepbls.html"><strong>kepbls</strong>: perform Box-Least Square searches for periodic exoplanet transits</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepclip.html"><strong>kepclip</strong>: remove unwanted time ranges from Kepler time series data</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepconvert.html"><strong>kepconvert</strong>: convert Kepler FITS time series to or from a different file format</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepcotrend.html"><strong>kepcotrend</strong>: remove systematic trends Kepler light curves using cotrending basis vectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepdetrend.html"><strong>kepdetrend</strong>: detrend aperture photometry data</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepdiffim.html"><strong>kepdiffim</strong>: difference imaging of pixels within a target mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepdraw.html"><strong>kepdraw</strong>: interactive plotting of Kepler time series data</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepdynamic.html"><strong>kepdynamic</strong>: construct a dynamic power spectrum from Kepler time series data</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepextract.html"><strong>kepextract</strong>: create a light curve from a target pixel file by summing user-selected pixels</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepffi.html"><strong>kepffi</strong>: display a portion of a Full Frame Image (FFI) and define custom target apertures</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepfilter.html"><strong>kepfilter</strong>: bandpass filtering of Kepler light curve data</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepflatten.html"><strong>kepflatten</strong>: remove low frequency variability from time-series, preserve transits and flares</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepfold.html"><strong>kepfold</strong>: phase-fold light curve data on linear ephemeris</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepft.html"><strong>kepft</strong>: calculate and store a Fourier Transform from a Kepler time series</a></li>
<li class="toctree-l4"><a class="reference internal" href="kephead.html"><strong>kephead</strong>: search for and list FITS keywords in Kepler data files</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepimages.html"><strong>kepimages</strong>: create a series of separate FITS image files from a Target Pixel File</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepmask.html"><strong>kepmask</strong>: plot, create or edit custom target masks for target pixel files</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepoutlier.html"><strong>kepoutlier</strong>: remove or replace statistical outliers from time series data</a></li>
<li class="toctree-l4"><a class="reference internal" href="keppca.html"><strong>keppca</strong>: perform principal component analysis upon a target pixel file</a></li>
<li class="toctree-l4"><a class="reference internal" href="keppixseries.html"><strong>keppixseries</strong>: individual time series photometry for all pixels within a target mask</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepprf.html"><strong>kepprf</strong>: fit a PSF model to a specific image within a Target Pixel File</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#"><strong>kepprfphot</strong>: fit a PSF model to time series observations within a Target Pixel File</a></li>
<li class="toctree-l4"><a class="reference internal" href="keprange.html"><strong>keprange</strong>: define time ranges interactively for use with other PyKE tasks</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepsff.html"><strong>kepsff</strong>: remove motion-correlated noise from aperture light curve data</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepsmooth.html"><strong>kepsmooth</strong>: smooth light curves by convolution with a choice of analytical function</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepstddev.html"><strong>kepstddev</strong>: calculate Combined Differential Photometric Precision for a time series light curve</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepstitch.html"><strong>kepstitch</strong>: append short cadence months and/or long cadence quarters</a></li>
<li class="toctree-l4"><a class="reference internal" href="keptimefix.html"><strong>keptimefix</strong>: correct a time stamp error in the target pixel files</a></li>
<li class="toctree-l4"><a class="reference internal" href="keptrial.html"><strong>keptrial</strong>: calculate best period and error estimate from time series</a></li>
<li class="toctree-l4"><a class="reference internal" href="keptrim.html"><strong>keptrim</strong>: trim pixels from Target Pixel Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="kepwindow.html"><strong>kepwindow</strong>: calculate and store the window function for a Kepler time series</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Photometry tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyKE</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../overview.html">PyKE tasks</a> &raquo;</li>
        
          <li><a href="index.html">List of PyKE tools</a> &raquo;</li>
        
      <li><strong>kepprfphot</strong>: fit a PSF model to time series observations within a Target Pixel File</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/kepprfphot.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="kepprfphot-fit-a-psf-model-to-time-series-observations-within-a-target-pixel-file">
<h1><strong>kepprfphot</strong>: fit a PSF model to time series observations within a Target Pixel File<a class="headerlink" href="#kepprfphot-fit-a-psf-model-to-time-series-observations-within-a-target-pixel-file" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="pyke.kepprfphot.kepprfphot">
<code class="descclassname">pyke.kepprfphot.</code><code class="descname">kepprfphot</code><span class="sig-paren">(</span><em>infile</em>, <em>prfdir</em>, <em>columns</em>, <em>rows</em>, <em>fluxes</em>, <em>border=0</em>, <em>background=False</em>, <em>focus=False</em>, <em>ranges='0</em>, <em>0'</em>, <em>xtol=0.0001</em>, <em>ftol=0.01</em>, <em>qualflags=False</em>, <em>outfile=None</em>, <em>plot=False</em>, <em>overwrite=False</em>, <em>verbose=False</em>, <em>logfile='kepprfphot.log'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyke/kepprfphot.html#kepprfphot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyke.kepprfphot.kepprfphot" title="Permalink to this definition">¶</a></dt>
<dd><p>kepprfphot – Fit a PSF model to time series observations within a Target
Pixel File</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>nfile</strong> : str</p>
<blockquote>
<div><p>The name of a MAST standard format FITS file containing Kepler Target
Pixel data within the first data extension.</p>
</div></blockquote>
<p><strong>columns</strong> : str or list</p>
<blockquote>
<div><p>A starting guess for the CCD column position(s) of the source(s) that
are to be fit. The model is unlikely to converge if the guess is too
far away from the correct location. A rule of thumb is to provide a
guess within 1 CCD pixel of the true position. If more than one source
is being modeled then the column positions of each are separated by a
comma. The same number of sources in the columns, rows and fluxes field
is a requirement of this task.</p>
</div></blockquote>
<p><strong>rows</strong> : str or list</p>
<blockquote>
<div><p>A starting guess for the CCD row position(s) of the source(s) that are
to be fit. The model is unlikely to converge if the guess is too far
away from the correct location. A rule of thumb is to provide a guess
within 1 CCD pixel of the true position. If more than one source is
being modeled then the row positions of each are separated by a comma.
The same number of sources in the columns, rows and fluxes field is a
requirement of this task.</p>
</div></blockquote>
<p><strong>fluxes</strong> : str or list</p>
<blockquote>
<div><p>A starting guess for the flux(es) of the source(s) that are to be fit.
Fit convergence is not particularly reliant on the accuracy of these
guesses, but the fit will converge faster the more accurate the guess.
If more than one source is being modeled then the row positions of
each are separated by a comma. The same number of sources in the
columns, rows and fluxes field is a requirement of this task.</p>
</div></blockquote>
<p><strong>prfdir</strong> : str</p>
<blockquote>
<div><p>The full or relative directory path to a folder containing the Kepler
PSF calibration. Calibration files can be downloaded from the Kepler
focal plane characteristics page at the MAST here:
<a class="reference external" href="http://archive.stsci.edu/missions/kepler/fpc/prf/">http://archive.stsci.edu/missions/kepler/fpc/prf/</a>.</p>
</div></blockquote>
<p><strong>border</strong> : int</p>
<blockquote>
<div><p>If a background is included in the fit then it is modeled as a
two-dimensional polynomial. This parameter is the polynomial order.
A zero-order polynomial is generally recommended.</p>
</div></blockquote>
<p><strong>background</strong> : bool</p>
<blockquote>
<div><p>Whether to include a background component in the model. If <code class="docutils literal"><span class="pre">True</span></code>
the background will be represented by a two-dimensional polynomial of
order border. This functionality is somewhat experimental, with one eye
upon potential background gradients across large masks or on those
detectors more prone to pattern noise. Generally it is recommended to
set background as <code class="docutils literal"><span class="pre">False</span></code>.</p>
</div></blockquote>
<p><strong>focus</strong> : bool</p>
<blockquote>
<div><p>Whether to include pixel scale and focus rotation with the fit
parameters of the model. This is also an experimental function. This
approach does not attempt to deal with inter- or intra-pixel
variations. The recommended use is currently to set focus as <code class="docutils literal"><span class="pre">False</span></code>.</p>
</div></blockquote>
<p><strong>ranges</strong> : str</p>
<blockquote>
<div><p>The user can choose specific time ranges of data on which to work. This
could, for example, avoid removing known stellar flares from a dataset
Time ranges are supplied as comma-separated pairs of Barycentric Julian
Dates (BJDs). Multiple ranges are separated by a semi-colon.
An example containing two time ranges is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s1">&#39;2455012.48517,2455014.50072;2455022.63487,2455025.08231&#39;</span>
</pre></div>
</div>
<p>If the user wants to correct the entire time series then providing
ranges = ‘0,0’ will tell the task to operate on the whole time series.</p>
</div></blockquote>
<p><strong>xtol</strong> : float</p>
<blockquote>
<div><p>The dimensionless, relative model parameter convergence criterion for
the fit algorithm.</p>
</div></blockquote>
<p><strong>ftol</strong> : float</p>
<blockquote>
<div><p>The dimensionless, relative model residual convergence criterion for
the fit algorithm.</p>
</div></blockquote>
<p><strong>qualflags</strong> : bool</p>
<blockquote>
<div><p>If qualflags is <code class="docutils literal"><span class="pre">False</span></code>, archived observations flagged with any
quality issue will not be fit.</p>
</div></blockquote>
<p><strong>outfile</strong> : str</p>
<blockquote>
<div><p>kepprfphot creates two types of output file containing fit results and
diagnostics. <code class="docutils literal"><span class="pre">outfile.png</span></code> contains a time series plot of fit
parameters, residuals and chi-squared. <code class="docutils literal"><span class="pre">outfile.fits</span></code> contains a
table of the same properties, consistent with Kepler archive light
curve files. The FITS column PSF_FLUX contains the flux time-series in
units of e-/s derived by integrating under the best-fit PRF model.
PSF_BKG provides the best-fit background (if calculated) averaged over
all mask pixels in units of e-/s/pixel. PSF_CENTR1 provides the
best-fit PSF centroid position in the CCD column direction, in CCD
pixel units. Similarly, PSF_CENTR2 provides the best-fit PSF centroid
position in the CCD row direction, in CCD pixel units. If calculated,
PSF_FOCUS1 and PSF_FOCUS2 provide scale factors in the column and row
dimensions by which the CCD pixel scale is adjusted to approximate
focus variation. PSF_ROTATION provides the angle by which the scaled
PSF model was rotated on the focal plane in order to yield a best fit.
The table column PSF_RESIDUAL provides the sum of all mask pixels
after the best-fit model has been subtracted from the data. PSF_CHI2
delivers the best-fit chi-squred statistic for each observation.</p>
</div></blockquote>
<p><strong>plot</strong> : bool</p>
<blockquote>
<div><p>Plot fit results to the screen?</p>
</div></blockquote>
<p><strong>verbose</strong> : bool</p>
<blockquote>
<div><p>Print informative messages and warnings to the shell and logfile?</p>
</div></blockquote>
<p><strong>logfile</strong> : str</p>
<blockquote class="last">
<div><p>Name of the logfile containing error and warning messages.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ kepprfphot kplr012557548-2012004120508_lpd-targ.fits.gz --columns <span class="m">95</span>
  --rows <span class="m">1020</span> --fluxes <span class="m">1</span>.0 --border <span class="m">0</span> --prfdir ../kplr2011265_prf --xtol 1e-7 --ftol 1e-7
  --plot --verbose

  --------------------------------------------------------------
  KEPPRFPHOT --  <span class="nv">infile</span><span class="o">=</span>kplr012557548-2012004120508_lpd-targ.fits.gz
  <span class="nv">columns</span><span class="o">=</span><span class="m">95</span> <span class="nv">rows</span><span class="o">=</span><span class="m">1020</span> <span class="nv">fluxes</span><span class="o">=</span><span class="m">1</span>.0 <span class="nv">border</span><span class="o">=</span><span class="m">0</span> <span class="nv">background</span><span class="o">=</span>False
  <span class="nv">focus</span><span class="o">=</span>False <span class="nv">prfdir</span><span class="o">=</span>../kplr2011265_prf <span class="nv">ranges</span><span class="o">=</span><span class="m">0</span>,0 <span class="nv">xtol</span><span class="o">=</span>1e-07 <span class="nv">ftol</span><span class="o">=</span>1e-07
  <span class="nv">qualflags</span><span class="o">=</span>False <span class="nv">plot</span><span class="o">=</span>True <span class="nv">overwrite</span><span class="o">=</span>True <span class="nv">verbose</span><span class="o">=</span>True <span class="nv">logfile</span><span class="o">=</span>kepprfphot.log

  KEPPRFPHOT started at: Wed Jun <span class="m">14</span> <span class="m">15</span>:33:30 <span class="m">2017</span>

        KepID: <span class="m">12557548</span>
   RA <span class="o">(</span>J2000<span class="o">)</span>: <span class="m">290</span>.96622
  Dec <span class="o">(</span>J2000<span class="o">)</span>: <span class="m">51</span>.50472
       KepMag: <span class="m">15</span>.692
     SkyGroup: <span class="m">4</span>
       Season: <span class="m">1</span>
      Channel: <span class="m">32</span>
       Module: <span class="m">10</span>
       Output: <span class="m">4</span>

   <span class="m">19</span>% <span class="nv">nrow</span> <span class="o">=</span> <span class="m">740</span> <span class="nv">t</span> <span class="o">=</span> <span class="m">0</span>.1 sec
</pre></div>
</div>
<img alt="../_images/kepprfphot.png" src="../_images/kepprfphot.png" />
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="keprange.html" class="btn btn-neutral float-right" title="keprange: define time ranges interactively for use with other PyKE tasks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="kepprf.html" class="btn btn-neutral" title="kepprf: fit a PSF model to a specific image within a Target Pixel File" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright PyKE Developers and Contributors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>